# projects.yaml — Project configuration for Kōan
#
# Place this file at your KOAN_ROOT (next to .env).
# Not versioned — copy from projects.example.yaml and customize.
#
# THREE WAYS TO CONFIGURE PROJECTS:
#
# 1. Workspace only (zero config):
#    Place a project or symlink in workspace/ — auto-discovered by directory name.
#    Uses global defaults. No yaml entry needed.
#
# 2. Yaml only (explicit path):
#    Define the project here with a 'path' field.
#
# 3. Workspace + yaml override (best of both):
#    Place the project in workspace/ AND add a yaml entry here WITHOUT 'path'.
#    The workspace provides the path, yaml provides custom settings.
#
# Precedence: If the same project name exists in both yaml (with path) and
# workspace, the yaml path wins. A warning is shown at startup.
#
# Max 50 projects total (workspace + yaml combined).
#
# This file replaces KOAN_PROJECTS / KOAN_PROJECT_PATH env vars.
# If projects.yaml exists, env vars are ignored (but still work as fallback
# if you delete this file).

defaults:
  # These apply to every project unless overridden
  git_auto_merge:
    enabled: false
    base_branch: "main"
    strategy: "squash"

  # CLI provider — which AI CLI to use ("claude", "copilot", "local")
  # Per-project overrides allow different providers for different repos.
  # Can also be set globally in config.yaml or via KOAN_CLI_PROVIDER env var.
  # cli_provider: "claude"

  # Model overrides — control which models are used per project.
  # Keys match config.yaml models section: mission, chat, lightweight,
  # fallback, review_mode. Empty string = use default model.
  # models:
  #   mission: ""
  #   chat: ""

  # Tool restrictions — control which tools are available per project.
  # Keys: mission (for autonomous work), chat (for Telegram conversations).
  # Useful for restricting write access on certain repos.
  # tools:
  #   mission: ["Read", "Glob", "Grep", "Edit", "Write", "Bash"]
  #   chat: ["Read", "Glob", "Grep"]

  # Exploration — whether the agent autonomously explores this project.
  # When false, the agent only works on explicit missions for the project.
  # Default: true
  # exploration: true

  # Max open PRs — limit how many open PRs the agent can have per repo
  # before autonomous exploration is paused. Explicit missions are never
  # affected. Uses GITHUB_USER or `gh` login to identify the agent's PRs.
  # Set to 0 or omit for unlimited.
  # Default: 0 (unlimited)
  max_open_prs: 10

projects:
  # Example: your main project (minimal config — inherits all defaults)
  myapp:
    path: "/Users/yourname/workspace/myapp"
    # github_url: "yourname/myapp"  # Auto-detected from git remote; override if needed
    # git_auto_merge:
    #   enabled: true
    #   strategy: "merge"

  # Example: workspace project with yaml overrides (no path needed!)
  # The project lives in workspace/my-lib (symlink or directory).
  # This yaml entry only provides custom settings.
  # my-lib:
  #   models:
  #     mission: "opus"          # Use Opus for complex work
  #   git_auto_merge:
  #     enabled: true

  # Example: a backend project with custom model and base branch
  # backend:
  #   path: "/Users/yourname/workspace/backend"
  #   git_auto_merge:
  #     base_branch: "staging"
  #   models:
  #     mission: "opus"          # Use Opus for complex backend work
  #     review_mode: "sonnet"    # Use Sonnet for cheaper reviews

  # Example: a small Perl module with restricted tools and cheaper model
  # perl-lib:
  #   path: "/Users/yourname/workspace/perl-lib"
  #   models:
  #     mission: "sonnet"        # Sonnet is sufficient for small modules
  #   tools:
  #     mission: ["Read", "Glob", "Grep", "Edit", "Write"]  # No Bash

  # Example: a read-only repo (audit/review only, no autonomous exploration)
  # vendor-lib:
  #   path: "/Users/yourname/workspace/vendor-lib"
  #   exploration: false                   # Only work on explicit missions
  #   tools:
  #     mission: ["Read", "Glob", "Grep"]  # Read-only — no modifications

  # Example: a project with a lower PR limit (overrides default of 10)
  # oss-lib:
  #   path: "/Users/yourname/workspace/oss-lib"
  #   max_open_prs: 3                        # Keep max 3 open PRs for this repo

  # Example: a project using GitHub Copilot instead of Claude
  # copilot-project:
  #   path: "/Users/yourname/workspace/copilot-project"
  #   cli_provider: "copilot"

  # Example: a project with restricted GitHub @mention access
  # restricted-repo:
  #   path: "/Users/yourname/workspace/restricted-repo"
  #   github:
  #     authorized_users: ["alice", "bob"]  # Override global list for this project
